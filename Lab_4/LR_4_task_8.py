import numpy as np
import matplotlib.pyplot as plt

# --- Вхідні дані ---
# Вектори даних з Завдання № 3 [cite: 157-167]
x_data = np.array([0.1, 0.3, 0.4, 0.6, 0.7])
y_data = np.array([3.2, 3.0, 1.0, 1.8, 1.9])

N = len(x_data) # Кількість точок (N=5), отже степінь полінома N-1 = 4

print(f"Вхідні дані X: {x_data}")
print(f"Вхідні дані Y: {y_data}\n")

# --- Крок 1: Заповнення матриці X (Матриця Вандермонда) ---
# [cite: 169]
# Створюємо матрицю X, де кожен рядок [1, x, x^2, x^3, x^4]
# (відповідно до теорії в лаб. роботі [cite: 148])
X = np.vander(x_data, N, increasing=True)
print("--- Крок 1: Матриця X (Вандермонда) ---")
print(X)
print("\n")

# --- Крок 2: Отримання коефіцієнтів інтерполяційного полінома ---
# [cite: 170]
# Ми розв'язуємо систему лінійних рівнянь X * A = Y, 
# де A - це вектор коефіцієнтів [a0, a1, a2, a3, a4]
# A = (X^-1) * Y
A = np.linalg.solve(X, y_data)
print("--- Крок 2: Коефіцієнти полінома [a0, a1, a2, a3, a4] ---")
print(A)
print("\n")

# --- Крок 3: Визначення функції полінома (степеню 4) ---
# 
# Створюємо функцію полінома. 
# np.poly1d очікує коефіцієнти від старшого степеня до молодшого,
# тому ми передаємо наш вектор A у зворотному порядку (A[::-1])
p = np.poly1d(A[::-1])
print("--- Крок 3: Інтерполяційний поліном P(x) ---")
print(p)
print("\n")

# --- Крок 4: Побудова графіка функції ---
# [cite: 172]
# Створюємо 100 точок для плавної лінії графіка
x_plot = np.linspace(min(x_data), max(x_data), 100)
y_plot = p(x_plot)

plt.figure(figsize=(10, 6))
# Малюємо поліном
plt.plot(x_plot, y_plot, label='Інтерполяційний поліном P(x)')
# Малюємо вихідні точки, щоб переконатись, що графік проходить через них
plt.scatter(x_data, y_data, color='red', s=100, zorder=5, 
            label='Експериментальні точки')
plt.title('Завдання 3: Інтерполяція поліномом 4-го степеня')
plt.xlabel('X')
plt.ylabel('Y')
plt.legend()
plt.grid(True)
plt.show()

# --- Крок 5: Визначити значення функції в проміжних точках ---
# [cite: 173]
x_intermediate_1 = 0.2
x_intermediate_2 = 0.5

y_at_0_2 = p(x_intermediate_1)
y_at_0_5 = p(x_intermediate_2)

print("--- Крок 5: Значення в проміжних точках ---")
print(f"Значення функції в точці x = {x_intermediate_1}:  P(0.2) = {y_at_0_2:.4f}")
print(f"Значення функції в точці x = {x_intermediate_2}:  P(0.5) = {y_at_0_5:.4f}")